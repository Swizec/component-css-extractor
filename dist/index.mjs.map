{"version":3,"file":"index.mjs","sources":["../src/index.js"],"sourcesContent":["import css from \"css\";\n\nfunction getClassNames(node) {\n    return [\n        node.className,\n        ...Array.from(node.children).map(getClassNames)\n    ].flat();\n}\n\nexport default function extractCSS(node) {\n    // Collect class names for a DOM subtree\n    // Works for styled-components and CSS modules (anything based on CSS classes)\n    const classNames = getClassNames(node)\n        .map(name => name.split(\" \"))\n        .flat()\n        .map(name => `.${name}`);\n\n    // Gets embedded CSS for the entire page\n    const cssStyles = Array.from(document.head.getElementsByTagName(\"style\"))\n        .map(style => style.innerHTML)\n        .join(\"\");\n\n    // Filters CSS for our classes\n    const parsedCSS = css.parse(cssStyles);\n    parsedCSS.stylesheet.rules = parsedCSS.stylesheet.rules\n        .filter(rule => rule.type === \"rule\")\n        .filter(rule =>\n            rule.selectors.some(selector =>\n                classNames.some(name => name === selector)\n            )\n        );\n\n    return css.stringify(parsedCSS);\n}\n"],"names":["getClassNames","node","className","Array","from","children","map","flat","classNames","name","split","cssStyles","document","head","getElementsByTagName","style","innerHTML","join","parsedCSS","css","parse","stylesheet","rules","filter","rule","type","selectors","some","selector","stringify"],"mappings":"mBAEA,SAASA,EAAcC,SACZ,CACHA,EAAKC,kBACFC,MAAMC,KAAKH,EAAKI,UAAUC,IAAIN,IACnCO,sBAGS,SAAoBN,OAGzBO,EAAaR,EAAcC,GAC5BK,aAAIG,UAAQA,EAAKC,MAAM,OACvBH,OACAD,aAAIG,aAAYA,IAGfE,EAAYR,MAAMC,KAAKQ,SAASC,KAAKC,qBAAqB,UAC3DR,aAAIS,UAASA,EAAMC,YACnBC,KAAK,IAGJC,EAAYC,EAAIC,MAAMT,UAC5BO,EAAUG,WAAWC,MAAQJ,EAAUG,WAAWC,MAC7CC,gBAAOC,SAAsB,SAAdA,EAAKC,OACpBF,gBAAOC,UACJA,EAAKE,UAAUC,cAAKC,UAChBpB,EAAWmB,cAAKlB,UAAQA,IAASmB,QAItCT,EAAIU,UAAUX"}